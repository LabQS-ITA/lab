<VirtualHost _default_:80>

    ServerName ${ST_LAB_DOMAIN}

    RedirectMatch permanent /(.*)$ https://${ST_LAB_DOMAIN}/

</VirtualHost>

<VirtualHost _default_:443>

    ServerName ${ST_LAB_DOMAIN}

    ProxyPass /ws ws://minio01:9000/ws upgrade=WebSocket
    ProxyPassReverse /ws ws://minio01:9000/ws

    ProxyPass / http://minio01:9001/
    ProxyPassReverse / http://minio01:9001/

    RemoteIPHeader X-Forwarded-For

    SSLEngine on

    SSLCertificateFile "certificates/live/${ST_LAB_DOMAIN}/fullchain.pem"
    SSLCertificateKeyFile "certificates/live/${ST_LAB_DOMAIN}/privkey.pem"

    Protocols h2 http/1.1

    Header always set Strict-Transport-Security "max-age=63072000"

</VirtualHost>
