<VirtualHost _default_:80>
  
    ServerName localhost

    <Proxy *>
        Order deny,allow
        Allow from all
    </Proxy>

    ProxyPreserveHost On
    ProxyRequests Off

    ErrorDocument 404 /404.html
    ErrorDocument 503 /503.html

    AllowEncodedSlashes NoDecode

    ErrorLog logs/error.log
    CustomLog logs/access.log combined

    <Directory /usr/local/apache2/htdocs>
        Allowoverride all
    </Directory>

    ProxyPass /adminer http://adminer:80
    ProxyPassReverse /adminer http://adminer:80

    ProxyPass /git http://gitea:3000
    ProxyPassReverse /git http://gitea:3000

    ProxyPass /commander http://commander:8081/commander
    ProxyPassReverse /commander http://commander:8081/commander

    ProxyPass /drone http://drone:80

    <Location /drone>
        ProxyPreserveHost Off
        ProxyErrorOverride On
        ProxyPassReverse http://drone:80

        ProxyPassReverseCookiePath / /drone/

        # ProxyHTMLEnable On # Causes "SyntaxError: Unexpected token '<' at /static/js/2.6edc03c8.chunk.js"
        ProxyHTMLExtended On
        ProxyHTMLURLMap http://drone:80
        SetOutputFilter INFLATE;proxy-html;DEFLATE
        RequestHeader unset Accept-Encoding
    </Location>

    ProxyPass /api http://drone:80/api

    <Location /api>
        ProxyPreserveHost Off
        ProxyErrorOverride On
        ProxyPassReverse http://drone:80/api

        ProxyPassReverseCookiePath / /api/

        # ProxyHTMLEnable On # Causes "SyntaxError: Unexpected token '<' at /static/js/2.6edc03c8.chunk.js"
        ProxyHTMLExtended On
        ProxyHTMLURLMap / /api/
        SetOutputFilter INFLATE;proxy-html;DEFLATE
        RequestHeader unset Accept-Encoding
    </Location>

</VirtualHost>
