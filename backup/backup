#!/usr/bin/env bash
set -euo pipefail

function backup_postgres() {

    docker exec -i $1 /usr/bin/pg_dumpall -U postgres -w | gzip -9 > .$1_`date +%F-%H%M`.sql.gz

}

function backup_mariadb() {

    docker exec -i $1 /usr/bin/mysqldump -u root -A | gzip -9 > .$1_`date +%F-%H%M`.sql.gz

}

backup_postgres postgres
backup_postgres postgres01
backup_postgres postgres02

backup_mariadb mariadb01
backup_mariadb mariadb02
